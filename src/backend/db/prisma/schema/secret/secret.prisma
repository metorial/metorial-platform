model SecretType {
  oid Int    @id @default(autoincrement())
  id  String @unique

  name String
  slug String @unique

  createdAt DateTime @default(now())

  secrets Secret[]
}

model SecretStore {
  oid Int    @id @default(autoincrement())
  id  String @unique

  name String
  slug String @unique

  createdAt DateTime @default(now())

  secrets Secret[]
}

enum SecretStatus {
  active
  deleted
}

model Secret {
  oid    BigInt       @id @default(autoincrement())
  id     String       @unique
  status SecretStatus

  description String?

  /// [Record]
  metadata Json

  fingerprint   String
  encryptedData String?

  typeOid Int
  type    SecretType @relation(fields: [typeOid], references: [oid])

  storeOid Int
  store    SecretStore @relation(fields: [storeOid], references: [oid])

  organizationOid BigInt
  organization    Organization @relation(fields: [organizationOid], references: [oid])

  instanceOid BigInt
  instance    Instance @relation(fields: [instanceOid], references: [oid])

  createdAt  DateTime  @default(now())
  lastUsedAt DateTime?

  events      SecretEvent[]
  deployments ServerDeployment[]
}
