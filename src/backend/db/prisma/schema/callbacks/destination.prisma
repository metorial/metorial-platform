enum CallbackDestinationSelectionType {
  all // We always send there
  selected
}

enum CallbackDestinationType {
  webhook_http
}

enum CallbackDestinationStatus {
  active
  inactive
}

model CallbackDestination {
  oid BigInt @id @default(autoincrement())
  id  String @unique

  status CallbackDestinationStatus @default(active)

  name        String
  description String?

  selectionType CallbackDestinationSelectionType
  type          CallbackDestinationType

  url           String?
  signingSecret String?

  instanceOid BigInt
  instance    Instance @relation(fields: [instanceOid], references: [oid])

  createdAt DateTime @default(now())

  callbacks     CallbackDestinationCallback[]
  notifications CallbackNotification[]
}

model CallbackDestinationCallback {
  isSelected Boolean

  callbackOid BigInt
  callback    Callback @relation(fields: [callbackOid], references: [oid], onDelete: Cascade)

  destinationOid BigInt
  destination    CallbackDestination @relation(fields: [destinationOid], references: [oid], onDelete: Cascade)

  @@id([callbackOid, destinationOid])
}
