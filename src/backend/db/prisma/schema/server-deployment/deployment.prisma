enum ServerDeploymentStatus {
  active
  archived
  deleted
}

model ServerDeployment {
  oid         BigInt                 @id @default(autoincrement())
  id          String                 @unique
  status      ServerDeploymentStatus
  isEphemeral Boolean

  name        String?
  description String?

  metadata Json?

  serverImplementationOid BigInt
  serverImplementation    ServerImplementation @relation(fields: [serverImplementationOid], references: [oid])

  serverVariantOid BigInt
  serverVariant    ServerVariant @relation(fields: [serverVariantOid], references: [oid])

  serverOid BigInt
  server    Server @relation(fields: [serverOid], references: [oid])

  configOid BigInt
  config    ServerDeploymentConfig @relation(fields: [configOid], references: [oid])

  instanceOid BigInt
  instance    Instance @relation(fields: [instanceOid], references: [oid])

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  serverRunErrors ServerRunError[]
  serverSessions  ServerSession[]
  serverRuns      ServerRun[]
}
