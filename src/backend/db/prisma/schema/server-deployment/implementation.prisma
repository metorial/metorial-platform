enum ServerImplementationStatus {
  active
  archived
  deleted
}

model ServerImplementation {
  oid    BigInt                     @id @default(autoincrement())
  id     String                     @unique
  status ServerImplementationStatus

  isEphemeral Boolean
  isDefault   Boolean? // FALSE = NULL to avoid unique constraint

  name        String?
  description String?

  metadata Json?

  getLaunchParams String?

  serverVariantOid BigInt
  serverVariant    ServerVariant @relation(fields: [serverVariantOid], references: [oid])

  serverOid BigInt
  server    Server @relation(fields: [serverOid], references: [oid])

  instanceOid BigInt
  instance    Instance @relation(fields: [instanceOid], references: [oid])

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  deployment ServerDeployment[]

  @@unique([serverVariantOid, instanceOid, isDefault])
}
