enum ServerListingStatus {
  active
  archived
  banned
}

model ServerListing {
  oid    BigInt              @id @default(autoincrement())
  id     String              @unique
  status ServerListingStatus

  isPublic Boolean @default(false)

  ownerOrganizationOid BigInt?
  ownerOrganization    Organization? @relation(fields: [ownerOrganizationOid], references: [oid])

  name String
  slug String @unique

  description String?
  readme      String?

  rank Int @default(0)

  skills String[]

  deploymentsCount    Int @default(0)
  repoStarsCount      Int @default(0)
  serverSessionsCount Int @default(0)
  serverMessagesCount Int @default(0)

  profileOid BigInt?
  profile    Profile? @relation(fields: [profileOid], references: [oid])

  serverOid BigInt @unique
  server    Server @relation(fields: [serverOid], references: [oid])

  categories  ServerListingCategory[]
  collections ServerListingCollection[]

  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @default(now()) @updatedAt
  rankUpdatedAt DateTime? @updatedAt

  @@index([rank])
}
