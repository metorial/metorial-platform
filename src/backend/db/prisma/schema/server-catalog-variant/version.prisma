model ServerVersion {
  oid BigInt @id @default(autoincrement())
  id  String @unique

  identifier String

  serverOid BigInt
  server    Server @relation(fields: [serverOid], references: [oid])

  serverVariantOid BigInt
  serverVariant    ServerVariant @relation(fields: [serverVariantOid], references: [oid])

  schemaOid BigInt
  schema    ServerConfigSchema @relation(fields: [schemaOid], references: [oid])

  getLaunchParams String

  sourceType  ServerVariantSourceType
  dockerImage String?
  dockerTag   String?

  remoteUrl            String?
  remoteServerProtocol RemoteServerProtocol @default(sse)

  mcpVersion String @default("2024-11-05")

  /// [ServerVersionTools]
  tools Json @default("null")

  /// [ServerVersionPrompts]
  prompts Json @default("null")

  /// [ServerVersionResourceTemplates]
  resourceTemplates Json @default("null")

  /// [ServerVersionServerInfo]
  serverInfo Json @default("null")

  /// [ServerVersionServerCapabilities]
  serverCapabilities Json @default("null")

  /// [ServerVersionServerInstructions]
  serverInstructions Json @default("null")

  lambdaOid BigInt?
  lambda    LambdaServerInstance? @relation(fields: [lambdaOid], references: [oid])

  customServerVersion CustomServerVersion?

  currentConfigFor ServerVariant[] @relation("ServerVariantCurrentServerConfig")
  serverRuns       ServerRun[]

  createdAt        DateTime  @default(now())
  lastDiscoveredAt DateTime?

  @@unique([identifier, serverVariantOid])
}
