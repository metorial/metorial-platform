enum SessionMessageType {
  request
  response
  notification
  error
  server_error
  unknown
  debug
}

enum SessionMessageSenderType {
  server
  client
}

model SessionMessage {
  id   String             @id
  type SessionMessageType

  senderType SessionMessageSenderType
  senderId   String

  engineMessageId String? @db.Uuid

  method String?

  /// [SessionMessageOriginalId]
  originalId Json?
  unifiedId  String?

  /// [SessionMessageMcpPayload]
  payload Json

  isHandled Boolean @default(false)

  sessionOid BigInt
  session    Session @relation(fields: [sessionOid], references: [oid])

  serverSessionOid BigInt
  serverSession    ServerSession @relation(fields: [serverSessionOid], references: [oid])

  createdAt DateTime @default(now())

  @@index([unifiedId])
}
