services:
  etcd:
    image: bitnami/etcd:latest
    ports:
      - '32379:2379'
      - '32380:2380'
    environment:
      - ALLOW_NONE_AUTHENTICATION=yes
    restart: unless-stopped

  mongodb:
    image: mongo:latest
    ports:
      - '32707:27017'
    volumes:
      - ./_volumes/mongodb:/data/db
    restart: unless-stopped
    environment:
      MONGO_INITDB_ROOT_USERNAME: mongo
      MONGO_INITDB_ROOT_PASSWORD: mongo

  redis-db:
    image: redis:latest
    ports:
      - '36379:6379'
    volumes:
      - ./_volumes/redis:/data
    restart: unless-stopped

  meilisearch:
    image: getmeili/meilisearch:v1.14
    ports:
      - '37700:7700'
    volumes:
      - ./_volumes/meilisearch:/meili_data
    environment:
      - MEILI_ENV=development
    restart: unless-stopped

  postgres-db:
    image: postgres:latest
    ports:
      - '35432:5432'
    volumes:
      - ./_volumes/postgres:/var/lib/postgresql/data
    environment:
      - POSTGRES_PASSWORD=postgres
      - POSTGRES_USER=postgres
    restart: unless-stopped

  minio:
    image: minio/minio:latest
    container_name: minio
    ports:
      - "9000:9000"  
      - "9001:9001"  # MinIO Console
    volumes:
      - ./_volumes/minio:/data
    environment:
      MINIO_ROOT_USER: minio
      MINIO_ROOT_PASSWORD: minio123
    command: server --console-address ":9001" /data
    restart: unless-stopped

  opensearch:
    image: opensearchproject/opensearch:2.9.0
    container_name: opensearch
    environment:
      - discovery.type=single-node
      - bootstrap.memory_lock=true
      - DISABLE_SECURITY_PLUGIN=true   # disable SSL & auth
      - "OPENSEARCH_JAVA_OPTS=-Xms512m -Xmx512m"
      - OPENSEARCH_USERNAME=admin
      - OPENSEARCH_PASSWORD=admin
    ulimits:
      memlock:
        soft: -1
        hard: -1
    ports:
      - "9200:9200"
      - "9600:9600"  # Performance analyzer
    volumes:
      - ./_volumes/opensearch:/usr/share/opensearch/data
    restart: unless-stopped

  opensearch-dashboards:
    image: opensearchproject/opensearch-dashboards:2.9.0
    container_name: opensearch-dashboards
    ports:
      - "5601:5601"
    environment:
      - OPENSEARCH_HOSTS=http://opensearch:9200
      - OPENSEARCH_USERNAME=admin
      - OPENSEARCH_PASSWORD=admin
      - DISABLE_SECURITY_DASHBOARDS_PLUGIN=true   # disable SSL & auth
    depends_on:
      - opensearch
    restart: unless-stopped